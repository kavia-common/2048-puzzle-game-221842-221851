{"is_source_file": true, "format": "Dart", "description": "This file defines the GameProvider class, a ChangeNotifier that manages the game state, user interactions, and logic integration for a 2048 puzzle game implemented in Flutter. It exposes methods to start a new game, move tiles, undo moves, and toggle sound/haptics, while maintaining the game board, scores, and historical state for undo functionality.", "external_files": ["../game/game.dart", "../utils/persistence.dart", "../utils/sound_haptics.dart"], "external_methods": ["Persistence.getBestScore", "Persistence.setBestScore", "GameLogic.newGame", "GameLogic.move", "GameLogic.targetWinValue"], "published": ["GameProvider", "Board", "MoveDirection", "MoveResult", "Tile", "GameLogic", "Persistence", "SoundHapticsService"], "classes": [{"name": "GameProvider", "description": "A ChangeNotifier that manages the game state, logic, persistence, and user interaction for the 2048 game."}], "methods": [{"name": "setSfxEnabled", "description": "Enables or disables sound and haptic feedback within the game."}, {"name": "resetOutcomeFlags", "description": "Resets transient flags indicating game outcome states without modifying the game board."}, {"name": "_loadBestScore", "description": "Asynchronously loads the best score from persistent storage."}, {"name": "newGame", "description": "Starts a new game, optionally with a specific seed for reproducibility, resetting the board, score, and history."}, {"name": "undo", "description": "Reverts the last move if undo history exists, restoring the previous board state and score."}, {"name": "moveLeft", "description": "Performs a move to the left, updating game state accordingly."}, {"name": "moveRight", "description": "Performs a move to the right, updating game state accordingly."}, {"name": "moveUp", "description": "Performs a move upwards, updating game state accordingly."}, {"name": "moveDown", "description": "Performs a move downwards, updating game state accordingly."}, {"name": "_performMove", "description": "Handles applying move results to update the game state, scores, flags, and trigger sound/haptics."}, {"name": "_applyResultToBoard", "description": "Reconstructs a game board by sequentially applying move, merge, and spawn effects from the move result."}], "calls": ["Persistence.getBestScore", "Persistence.setBestScore", "GameLogic.newGame", "GameLogic.move", "notifyListeners", "_sfx.setEnabled", "_sfx.onRestart", "_sfx.onUndo", "_sfx.onInvalidMove", "_sfx.onMerge", "_sfx.onMoveValid", "_sfx.onSpawn", "_sfx.onWin", "_sfx.onLose"], "search-terms": ["Flutter game state management", "2048 game logic", "undo feature", "score persistence", "sound and haptic feedback", "game move handling", "board state management", "move directions", "best score tracking"], "state": 2, "file_id": 20, "knowledge_revision": 153, "git_revision": "", "revision_history": [{"43": ""}, {"44": ""}, {"62": ""}, {"63": ""}, {"64": ""}, {"66": ""}, {"104": ""}, {"127": ""}, {"137": ""}, {"138": ""}, {"145": ""}, {"146": ""}, {"153": ""}], "hash": "a01e2af1404da7bc260d81c9c82ac942", "format-version": 4, "code-base-name": "frontend_flutter", "filename": "frontend_flutter/lib/providers/game_provider.dart"}