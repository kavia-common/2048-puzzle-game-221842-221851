{"is_source_file": true, "format": "Dart", "description": "The file defines a Flutter ChangeNotifier class named GameProvider which manages the game state for a 2048 puzzle game. It handles game logic interactions, state updates, undo functionality, score management, persistence, and sound/haptic feedback. It imports core Dart libraries and custom modules related to game logic, persistence, and sound/haptics.", "external_files": ["../game/game.dart", "../utils/persistence.dart", "../utils/sound_haptics.dart"], "external_methods": ["Persistence.getBestScore", "Persistence.setBestScore", "GameLogic.newGame", "GameLogic.move", "GameLogic.targetWinValue"], "published": ["GameProvider", "setSfxEnabled"], "classes": [{"name": "GameProvider", "description": "A ChangeNotifier that acts as an interface between the core game logic and Flutter UI, managing game state, moves, undo, score, flags, and feedback."}, {"name": "_GameSnapshot", "description": "A private class representing a snapshot of the game state for undo functionality."}, {"name": "TileRef", "description": "A lightweight reference holder for a tile's reference, position, used internally during board reconstruction."}], "methods": [{"name": "setSfxEnabled", "description": "Public method to toggle sound and haptic feedback enabled state."}, {"name": "resetOutcomeFlags", "description": "Resets transient flags indicating game win or over status without modifying the board."}, {"name": "_loadBestScore", "description": "Asynchronously loads the best score from persistent storage."}, {"name": "newGame", "description": "Starts a new game by resetting the board, score, flags, and restoring previous best score."}, {"name": "undo", "description": "Reverts the last move using stored game snapshots."}, {"name": "moveLeft", "description": "Performs a move to the left in the game."}, {"name": "moveRight", "description": "Performs a move to the right in the game."}, {"name": "moveUp", "description": "Performs a move upward in the game."}, {"name": "moveDown", "description": "Performs a move downward in the game."}, {"name": "_performMove", "description": "Core handler that updates game state after a move result, updating board, score, flags, and triggering sound feedback."}, {"name": "_applyResultToBoard", "description": "Reconstructs the board based on move steps, merges, and spawns after a move."}], "calls": ["GameLogic.newGame", "GameLogic.move", "Persistence.getBestScore", "Persistence.setBestScore", "notifyListeners", "SoundHapticsService.setEnabled", "SoundHapticsService.onMerge", "SoundHapticsService.onMoveValid", "SoundHapticsService.onSpawn", "SoundHapticsService.onWin", "SoundHapticsService.onLose", "SoundHapticsService.onUndo", "SoundHapticsService.onRestart", "GameLogic.targetWinValue"], "search-terms": ["GameProvider", "undo stack", "score persistence", "move handling", "sound haptics", "deterministic seed", "game state management", "2048 Dart Flutter"], "state": 2, "file_id": 20, "knowledge_revision": 146, "git_revision": "", "revision_history": [{"43": ""}, {"44": ""}, {"62": ""}, {"63": ""}, {"64": ""}, {"66": ""}, {"104": ""}, {"127": ""}, {"137": ""}, {"138": ""}, {"145": ""}, {"146": ""}], "hash": "50a69120d42a3c60264d62eb08e796ae", "format-version": 4, "code-base-name": "frontend_flutter", "filename": "frontend_flutter/lib/providers/game_provider.dart"}