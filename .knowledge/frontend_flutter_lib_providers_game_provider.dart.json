{"is_source_file": true, "format": "Dart", "description": "This file contains the implementation of the GameProvider class, which manages the game state and client interactions for a 2048 puzzle game using Flutter. It bridges the core game logic with the Flutter UI, handles moves, undo, game state flags, sound effects, persistence, and communicates with other modules like GameLogic, persistence utils, and sound/haptics services.", "external_files": ["../game/game.dart", "../utils/persistence.dart", "../utils/sound_haptics.dart"], "external_methods": ["GameLogic.newGame", "GameLogic.move", "Persistence.getBestScore", "Persistence.setBestScore", "SoundHapticsService.enabled", "SoundHapticsService.setEnabled", "SoundHapticsService.onRestart", "SoundHapticsService.onUndo", "SoundHapticsService.onMerge", "SoundHapticsService.onMoveValid", "SoundHapticsService.onSpawn", "SoundHapticsService.onWin", "SoundHapticsService.onLose"], "published": ["GameProvider", "moveLeft", "moveRight", "moveUp", "moveDown", "newGame", "undo", "setSfxEnabled", "resetOutcomeFlags"], "classes": [{"name": "GameProvider", "description": "A ChangeNotifier that manages the 2048 game state, including board, score, game flags, move history, sound/haptics, and persistence for best score. It provides methods to start new games, undo moves, perform directional moves, toggle sound effects, and load/save persistent data.", "methods": [{"name": "GameProvider", "description": "Constructor initializing game state, optionally with a seed for reproducible behavior, loading initial flags and best scores."}, {"name": "setSfxEnabled", "description": "Enables or disables sound and haptics feedback."}, {"name": "resetOutcomeFlags", "description": "Resets transient game outcome flags like win and game over."}, {"name": "_loadBestScore", "description": "Asynchronously loads the best score from persistent storage."}, {"name": "newGame", "description": "Starts a new game, resetting board, score, flags, and optionally reseeding RNG."}, {"name": "undo", "description": "Undoes the last move by restoring previous snapshot."}, {"name": "moveLeft", "description": "Performs a move to the left."}, {"name": "moveRight", "description": "Performs a move to the right."}, {"name": "moveUp", "description": "Performs an upward move."}, {"name": "moveDown", "description": "Performs a downward move."}, {"name": "_performMove", "description": "Handles applying move results, updating score, flags, and triggering sounds."}, {"name": "_applyResultToBoard", "description": "Rebuilds the Board after move operations applying moves, merges, spawns."}], "attributes": [{"name": "board", "description": "Current game Board state."}, {"name": "score", "description": "Current game score."}, {"name": "best", "description": "Best score attained."}, {"name": "hasWon", "description": "Flag indicating if the game has been won."}, {"name": "isGameOver", "description": "Flag indicating if the game is over (no more moves)."}, {"name": "sfxEnabled", "description": "Flag indicating if sound/haptics effects are enabled."}], "inner_classes": [{"name": "_GameSnapshot", "description": "A snapshot of game state for undo functionality, containing board, score, hasWon, and isGameOver flags."}, {"name": "TileRef", "description": "A lightweight reference to a tile on the board, including tile object and position."}]}], "methods": null, "calls": ["GameLogic.newGame", "GameLogic.move", "Persistence.getBestScore", "Persistence.setBestScore", "SoundHapticsService.setEnabled", "SoundHapticsService.onRestart", "SoundHapticsService.onUndo", "SoundHapticsService.onMerge", "SoundHapticsService.onMoveValid", "SoundHapticsService.onSpawn", "SoundHapticsService.onWin", "SoundHapticsService.onLose"], "search-terms": ["GameProvider", "2048", "game state management", "move logic", "undo feature", "sound effects toggle", "persistent best score", "flutter change notifier", "game reset", "move directions"], "state": 2, "file_id": 20, "knowledge_revision": 166, "git_revision": "", "revision_history": [{"43": ""}, {"44": ""}, {"62": ""}, {"63": ""}, {"64": ""}, {"66": ""}, {"104": ""}, {"127": ""}, {"137": ""}, {"138": ""}, {"145": ""}, {"146": ""}, {"153": ""}, {"166": ""}], "hash": "f1b45c256db0452c8202934dba6f36cc", "format-version": 4, "code-base-name": "frontend_flutter", "filename": "frontend_flutter/lib/providers/game_provider.dart"}